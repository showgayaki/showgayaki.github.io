---
import type { ImageMetadata } from 'astro';
import { Image } from "astro:assets";

import "../styles/_app-detail.scss";
import "../styles/_store-link.scss";

const { detail } = Astro.props;
const imagePath = (value: string): string | void => {
    switch (value) {
        case "appstore": {
            return `badge-${value}.svg`;
        }
        case "googleplay": {
            return `badge-${value}.png`;
        }
    }
};
console.log(detail)
const images = import.meta.glob<{ default: ImageMetadata }>('../images/*.{jpeg,jpg,png,gif,svg}');
if (!images[`../images/${detail.iconFile}`]) {
    throw new Error(`"${detail.iconFile}" does not exist in glob: "src/images/*.{jpeg,jpg,png,gif}"`);
}
---

<section class="app-detail">
    <h3 class="app-detail__app-name">{detail.name}</h3>
    <p class="app-detail__description">{detail.description}</p>
    <ul class="app-detail__store-links store-link">
    {
        detail.stores.map((store: any) => (
            function () {
                if (`${store.url}` != '') {
                    return (
                        <Fragment>
                            <li class="store-link__item">
                                <a
                                    class="store-link__item-link"
                                    href={`${store.url}`}
                                    target="_blank"
                                >
                                    <Image
                                        class={`store-link__image store-link__image--${store.vendor}`}
                                        src={images[`../images/${imagePath(store.vendor)}`]()}
                                        alt={`${store.vendor} Badge`}
                                    />
                                </a>
                            </li>
                        </Fragment>
                    );
                }
            }
        ))
    }
    </ul>
</section>
